{
    # Global options - use production ACME only
    acme_ca https://acme-v02.api.letsencrypt.org/directory
}

# =========================
# API (reverse proxy only)
# =========================
# Frontend is served by Render, backend API only
# CORS is handled by FastAPI middleware
api.repduel.com {
    encode zstd gzip

    # Static files with caching
    @static {
        path /static/*
    }
    handle @static {
        header Cache-Control "public, max-age=31536000, immutable"
        reverse_proxy 127.0.0.1:9999
    }

    # Proxy all other requests to FastAPI backend
    handle {
        reverse_proxy 127.0.0.1:9999
    }

    # Error handling
    handle_errors {
        respond "{http.error.status_code} {http.error.status_text}"
    }
}